<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Ù„Ø¹Ø¨Ø© Ø§Ù„ÙØ¶Ø§Ø¡ ÙˆØ§Ù„ØµÙˆØ§Ø±ÙŠØ®</title>
<style>
  * { margin:0; padding:0; box-sizing:border-box; }
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: black;
    overflow: hidden;
    color: white;
    touch-action: none;
  }
  canvas { display:block; margin:auto; background:black; }
  #ui {
    position:absolute;
    top:0; left:0; width:100%; text-align:center;
    z-index:10;
  }
  #startScreen, #gameOverScreen {
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    height:100vh;
    font-size: 28px;
    color:white;
    background: rgba(0,0,0,0.7);
  }
  button {
    padding:15px 30px;
    margin-top:20px;
    font-size:20px;
    cursor:pointer;
    border:none;
    border-radius:10px;
    background:#00ffff;
    color:black;
    font-weight:bold;
  }
  #score, #highScore {
    font-size:24px;
    margin-top:10px;
    text-shadow:0 0 10px yellow;
  }
</style>
</head>
<body>

<div id="ui">
  <div id="startScreen">
    <div>ğŸš€ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø© ğŸš€</div>
    <div id="highScore">Ø£Ø¹Ù„Ù‰ Ù†ØªÙŠØ¬Ø©: 0</div>
    <button onclick="startGame()">Ø§Ø¨Ø¯Ø£</button>
  </div>

  <div id="gameOverScreen" style="display:none;">
    <div id="finalScore">Ù†Ù‚Ø§Ø·Ùƒ: 0</div>
    <div id="highScoreGameOver">Ø£Ø¹Ù„Ù‰ Ù†ØªÙŠØ¬Ø©: 0</div>
    <button onclick="startGame()">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨</button>
  </div>

  <div id="score">Ø§Ù„Ù†Ù‚Ø§Ø·: 0</div>
</div>

<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let gameInterval, score = 0, highScore = localStorage.getItem('highScore') || 0;
let gameState = 'start'; // start, playing, over

// Ø§Ù„Ù„Ø§Ø¹Ø¨
const player = {
    x: canvas.width*0.1,
    y: canvas.height/2,
    width: 60,
    height: 60,
    speed: 7,
    color:'#00ffff'
};
let bullets = [], enemies = [], stars = [];

// Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø®Ù„ÙÙŠØ©: Ù†Ø¬ÙˆÙ… Ù…ØªØ­Ø±ÙƒØ©
for(let i=0;i<150;i++){
    stars.push({
        x: Math.random()*canvas.width,
        y: Math.random()*canvas.height,
        size: Math.random()*2+1,
        speed: Math.random()*1.5+0.5
    });
}

// ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø¨Ø§Ù„Ù„Ù…Ø³
let touchY=null;
canvas.addEventListener('touchstart', e=>{ touchY=e.touches[0].clientY; shoot(); });
canvas.addEventListener('touchmove', e=>{
    const y=e.touches[0].clientY;
    player.y+=(y-touchY);
    if(player.y<0) player.y=0;
    if(player.y+player.height>canvas.height) player.y=canvas.height-player.height;
    touchY=y;
});

// Ø¥Ø·Ù„Ø§Ù‚ Ø§Ù„ØµÙˆØ§Ø±ÙŠØ®
function shoot() {
    bullets.push({
        x: player.x + player.width,
        y: player.y + player.height/2 -10,
        width:20,
        height:5,
        color:'#ffeb3b',
        speed:12
    });
}

// Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡
function spawnEnemy() {
    const y = Math.random()*(canvas.height-60);
    enemies.push({
        x: canvas.width + 60,
        y: y,
        width:60,
        height:60,
        color:'#ff3d00',
        speed:3+Math.random()*2
    });
}

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù„Ø¹Ø¨Ø©
function update() {
    // ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ù†Ø¬ÙˆÙ…
    stars.forEach(s=>{
        s.x-=s.speed;
        if(s.x<0) s.x=canvas.width;
    });

    // ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø±ØµØ§ØµØ§Øª
    bullets.forEach((b,i)=>{
        b.x+=b.speed;
        if(b.x>canvas.width) bullets.splice(i,1);
    });

    // ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡
    enemies.forEach((e,i)=>{
        e.x-=e.speed;
        if(e.x+e.width<0) enemies.splice(i,1);
    });

    // ØªØµØ§Ø¯Ù… Ø§Ù„Ø±ØµØ§Øµ Ù…Ø¹ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡
    bullets.forEach((b,bi)=>{
        enemies.forEach((e,ei)=>{
            if(b.x<e.x+e.width && b.x+b.width>e.x &&
               b.y<e.y+e.height && b.y+b.height>e.y){
                bullets.splice(bi,1);
                enemies.splice(ei,1);
                score+=10;
                document.getElementById('score').innerText='Ø§Ù„Ù†Ù‚Ø§Ø·: '+score;
            }
        });
    });

    // ØªØµØ§Ø¯Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù…Ø¹ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡
    enemies.forEach(e=>{
        if(player.x<e.x+e.width && player.x+player.width>e.x &&
           player.y<e.y+e.height && player.y+player.height>e.y){
               endGame();
        }
    });

    // Ø¸Ù‡ÙˆØ± Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡ Ø¨Ø´ÙƒÙ„ Ø¹Ø´ÙˆØ§Ø¦ÙŠ
    if(Math.random()<0.03) spawnEnemy();
}

// Ø±Ø³Ù… Ø§Ù„Ù„Ø¹Ø¨Ø©
function draw() {
    ctx.clearRect(0,0,canvas.width,canvas.height);

    // Ø§Ù„Ø®Ù„ÙÙŠØ©: Ø§Ù„Ù†Ø¬ÙˆÙ…
    ctx.fillStyle='white';
    stars.forEach(s=>{
        ctx.beginPath();
        ctx.arc(s.x,s.y,s.size,0,Math.PI*2);
        ctx.fill();
    });

    // Ø§Ù„Ù„Ø§Ø¹Ø¨: Ù…Ø±ÙƒØ¨Ø© ÙØ¶Ø§Ø¦ÙŠØ©
    ctx.fillStyle=player.color;
    ctx.beginPath();
    ctx.moveTo(player.x, player.y+player.height/2);
    ctx.lineTo(player.x+player.width, player.y);
    ctx.lineTo(player.x+player.width, player.y+player.height);
    ctx.closePath();
    ctx.fill();

    // Ø§Ù„Ø±ØµØ§ØµØ§Øª
    bullets.forEach(b=>{
        ctx.fillStyle=b.color;
        ctx.fillRect(b.x,b.y,b.width,b.height);
    });

    // Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡: ØµÙˆØ§Ø±ÙŠØ® Ø­Ù…Ø±Ø§Ø¡
    enemies.forEach(e=>{
        ctx.fillStyle=e.color;
        ctx.beginPath();
        ctx.moveTo(e.x,e.y+e.height/2);
        ctx.lineTo(e.x+e.width,e.y);
        ctx.lineTo(e.x+e.width,e.y+e.height);
        ctx.closePath();
        ctx.fill();
    });
}

// Ø­Ù„Ù‚Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
function gameLoop() {
    if(gameState==='playing'){
        update();
        draw();
        requestAnimationFrame(gameLoop);
    }
}

// Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©
function startGame(){
    document.getElementById('startScreen').style.display='none';
    document.getElementById('gameOverScreen').style.display='none';
    score=0;
    bullets=[]; enemies=[];
    player.y=canvas.height/2;
    document.getElementById('score').innerText='Ø§Ù„Ù†Ù‚Ø§Ø·: 0';
    document.getElementById('score').style.display='block';
    gameState='playing';
    gameLoop();
}

// Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©
function endGame(){
    gameState='over';
    document.getElementById('score').style.display='none';
    if(score>highScore){
        highScore=score;
        localStorage.setItem('highScore',highScore);
    }
    document.getElementById('finalScore').innerText='Ù†Ù‚Ø§Ø·Ùƒ: '+score;
    document.getElementById('highScoreGameOver').innerText='Ø£Ø¹Ù„Ù‰ Ù†ØªÙŠØ¬Ø©: '+highScore;
    document.getElementById('gameOverScreen').style.display='flex';
}

// Ø¹Ø±Ø¶ Ø£Ø¹Ù„Ù‰ Ù†ØªÙŠØ¬Ø© ÙÙŠ Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
document.getElementById('highScore').innerText='Ø£Ø¹Ù„Ù‰ Ù†ØªÙŠØ¬Ø©: '+highScore;

// Ø¶Ø¨Ø· Ø§Ù„Ø­Ø¬Ù… Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø©
window.addEventListener('resize',()=>{
    canvas.width=window.innerWidth;
    canvas.height=window.innerHeight;
});
</script>

</body>
</html>